<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<HTML>

<!-- Mirrored from undocumented.ntinternals.net/UserMode/Undocumented Functions/Executable Images/LdrQueryProcessModuleInformation.html by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 24 Apr 2010 18:23:35 GMT -->
<HEAD>
	<TITLE>LdrQueryProcessModuleInformation</TITLE>
	<LINK HREF="../../../tomek.css" REL="stylesheet" TYPE="text/css" TITLE="Style">
</HEAD>

<BODY>

<H3 CLASS="Header">Undocumented functions of NTDLL</H3>
<P ALIGN="right" CLASS="CompileDate">2OOO, 22 October</P>
<BR>
<center>
<script type="text/javascript"><!--
google_ad_client = "pub-8635618593004815";
/* NTinternals Horizontal, 728x90 */
google_ad_slot = "4640181396";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="../../../../pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</center>

<BR>
<DIV CLASS="text" >LdrQueryProcessModuleInformation</DIV>
<DIV CLASS="highlight" >LdrQueryProcessModuleInformation</DIV>
<BR>

<PRE CLASS="FnDefinition">
NTSYSAPI 
NTSTATUS
NTAPI
<P CLASS="FnDefName">LdrQueryProcessModuleInformation(
<P CLASS="FnDefParams">
  OUT PSYSTEM_MODULE_INFORMATION <I><FONT COLOR="blue">SystemModuleInformationBuffer</FONT></I>,
  IN ULONG                <I><FONT COLOR="blue">BufferSize</FONT></I>,
  OUT PULONG              <I><FONT COLOR="blue">RequiredSize</FONT></I> OPTIONAL );</P>  

</PRE>

<BR><BR>


<PRE>
<DIV CLASS="reg">Use for enumerate modules loaded with current process.</DIV>

<H6>BufferSize</H6>
<DIV CLASS="reg">Required minimum size is <B>sizeof(</B><A href="../../Structures/SYSTEM_MODULE_INFORMATION.html">SYSTEM_MODULE_INFORMATION</A><B>)</B> (4 bytes).
</DIV>
</PRE>

<DIV CLASS="Require">Example results:</DIV><BR>

<TABLE WIDTH="1151" BORDER="1" CELLSPACING="0" CELLPADDING="2">
   <TR>
    <TH>Name</TH>
    <TH>Path</TH>
    <TH>Res01</TH>
    <TH>Res02</TH>
    <TH>Address</TH>
    <TH>Size</TH>
    <TH>Flags</TH>
    <TH>ID</TH>
    <TH>Rank</TH>
  <TH>w18</TH>
  <TR>
    <TD width="10%" height=17><B><FONT face=Arial size=2>
      <P align=left>EnumModules.exe</B></FONT></P></TD>
    <TD width="31%" height=17><FONT face=Arial size=2>
      <P align=left>D:/Program Files/Microsoft Visual 
    Studio/MyProject...</FONT></P></TD>
    <TD width="9%" height=17><FONT face="Courier New" size=2>
      <P align=center>BAADF00D</FONT></P></TD>
    <TD width="8%" height=17><FONT face="Courier New" size=2>
      <P align=right>00000000</FONT></P></TD>
    <TD width="8%" height=17><FONT face="Courier New" size=2>
      <P align=right>00400000</FONT></P></TD>
    <TD width="8%" height=17><FONT face="Courier New" size=2>
      <P align=right>00016000</FONT></P></TD>
    <TD width="9%" height=17><FONT face="Courier New" size=2>
      <P align=center>00005000</FONT></P></TD>
    <TD width="6%" height=17><FONT face="Courier New" size=2>
      <P align=right>000</FONT></P></TD>
    <TD width="6%" height=17><FONT face="Courier New" size=2>
      <P align=right>0006</FONT></P></TD>
    <TD width="6%" height=17><FONT face="Courier New" size=2>
      <P align=right>65535</FONT></P></TD></TR>
  <TR>
    <TD width="10%" height=17><B><FONT face=Arial size=2>
      <P align=left>ntdll.dll</B></FONT></P></TD>
    <TD width="31%" height=17><FONT face=Arial size=2>
      <P align=left>C:/WINNT/System32/ntdll.dll</FONT></P></TD>
    <TD width="9%" height=17><FONT face="Courier New" size=2>
      <P align=center>BAADF00D</FONT></P></TD>
    <TD width="8%" height=17><FONT face="Courier New" size=2>
      <P align=right>00000000</FONT></P></TD>
    <TD width="8%" height=17><FONT face="Courier New" size=2>
      <P align=right>77F60000</FONT></P></TD>
    <TD width="8%" height=17><FONT face="Courier New" size=2>
      <P align=right>0005F000</FONT></P></TD>
    <TD width="9%" height=17><FONT face="Courier New" size=2>
      <P align=center>00004004</FONT></P></TD>
    <TD width="6%" height=17><FONT face="Courier New" size=2>
      <P align=right>001</FONT></P></TD>
    <TD width="6%" height=17><FONT face="Courier New" size=2>
      <P align=right>0001</FONT></P></TD>
    <TD width="6%" height=17><FONT face="Courier New" size=2>
      <P align=right>65535</FONT></P></TD></TR>
  <TR>
    <TD width="10%" height=17><B><FONT face=Arial size=2>
      <P align=left>KERNEL32.dll</B></FONT></P></TD>
    <TD width="31%" height=17><FONT face=Arial size=2>
      <P align=left>C:/WINNT/system32/KERNEL32.dll</FONT></P></TD>
    <TD width="9%" height=17><FONT face="Courier New" size=2>
      <P align=center>BAADF00D</FONT></P></TD>
    <TD width="8%" height=17><FONT face="Courier New" size=2>
      <P align=right>00000000</FONT></P></TD>
    <TD width="8%" height=17><FONT face="Courier New" size=2>
      <P align=right>77F00000</FONT></P></TD>
    <TD width="8%" height=17><FONT face="Courier New" size=2>
      <P align=right>00060000</FONT></P></TD>
    <TD width="9%" height=17><FONT face="Courier New" size=2>
      <P align=center>000C4006</FONT></P></TD>
    <TD width="6%" height=17><FONT face="Courier New" size=2>
      <P align=right>002</FONT></P></TD>
    <TD width="6%" height=17><FONT face="Courier New" size=2>
      <P align=right>0002</FONT></P></TD>
    <TD width="6%" height=17><FONT face="Courier New" size=2>
      <P align=right>65535</FONT></P></TD></TR>
  <TR>
    <TD width="10%" height=17><B><FONT face=Arial size=2>
      <P align=left>USER32.dll</B></FONT></P></TD>
    <TD width="31%" height=17><FONT face=Arial size=2>
      <P align=left>C:/WINNT/system32/USER32.dll</FONT></P></TD>
    <TD width="9%" height=17><FONT face="Courier New" size=2>
      <P align=center>BAADF00D</FONT></P></TD>
    <TD width="8%" height=17><FONT face="Courier New" size=2>
      <P align=right>00000000</FONT></P></TD>
    <TD width="8%" height=17><FONT face="Courier New" size=2>
      <P align=right>77E70000</FONT></P></TD>
    <TD width="8%" height=17><FONT face="Courier New" size=2>
      <P align=right>00055000</FONT></P></TD>
    <TD width="9%" height=17><FONT face="Courier New" size=2>
      <P align=center>00084006</FONT></P></TD>
    <TD width="6%" height=17><FONT face="Courier New" size=2>
      <P align=right>003</FONT></P></TD>
    <TD width="6%" height=17><FONT face="Courier New" size=2>
      <P align=right>0006</FONT></P></TD>
    <TD width="6%" height=17><FONT face="Courier New" size=2>
      <P align=right>65535</FONT></P></TD></TR>
  <TR>
    <TD width="10%" height=17><B><FONT face=Arial size=2>
      <P align=left>GDI32.dll</B></FONT></P></TD>
    <TD width="31%" height=17><FONT face=Arial size=2>
      <P align=left>C:/WINNT/system32/GDI32.dll</FONT></P></TD>
    <TD width="9%" height=17><FONT face="Courier New" size=2>
      <P align=center>BAADF00D</FONT></P></TD>
    <TD width="8%" height=17><FONT face="Courier New" size=2>
      <P align=right>00000000</FONT></P></TD>
    <TD width="8%" height=17><FONT face="Courier New" size=2>
      <P align=right>77ED0000</FONT></P></TD>
    <TD width="8%" height=17><FONT face="Courier New" size=2>
      <P align=right>0002C000</FONT></P></TD>
    <TD width="9%" height=17><FONT face="Courier New" size=2>
      <P align=center>00004006</FONT></P></TD>
    <TD width="6%" height=17><FONT face="Courier New" size=2>
      <P align=right>004</FONT></P></TD>
    <TD width="6%" height=17><FONT face="Courier New" size=2>
      <P align=right>0005</FONT></P></TD>
    <TD width="6%" height=17><FONT face="Courier New" size=2>
      <P align=right>65535</FONT></P></TD></TR>
  <TR>
    <TD width="10%" height=17><B><FONT face=Arial size=2>
      <P align=left>ADVAPI32.dll</B></FONT></P></TD>
    <TD width="31%" height=17><FONT face=Arial size=2>
      <P align=left>C:/WINNT/system32/ADVAPI32.dll</FONT></P></TD>
    <TD width="9%" height=17><FONT face="Courier New" size=2>
      <P align=center>BAADF00D</FONT></P></TD>
    <TD width="8%" height=17><FONT face="Courier New" size=2>
      <P align=right>00000000</FONT></P></TD>
    <TD width="8%" height=17><FONT face="Courier New" size=2>
      <P align=right>77DC0000</FONT></P></TD>
    <TD width="8%" height=17><FONT face="Courier New" size=2>
      <P align=right>0003F000</FONT></P></TD>
    <TD width="9%" height=17><FONT face="Courier New" size=2>
      <P align=center>000C4006</FONT></P></TD>
    <TD width="6%" height=17><FONT face="Courier New" size=2>
      <P align=right>005</FONT></P></TD>
    <TD width="6%" height=17><FONT face="Courier New" size=2>
      <P align=right>0004</FONT></P></TD>
    <TD width="6%" height=17><FONT face="Courier New" size=2>
      <P align=right>65535</FONT></P></TD></TR>
  <TR>
    <TD width="10%" height=17><B><FONT face=Arial size=2>
      <P align=left>RPCRT4.dll</B></FONT></P></TD>
    <TD width="31%" height=17><FONT face=Arial size=2>
      <P align=left>C:/WINNT/system32/RPCRT4.dll</FONT></P></TD>
    <TD width="9%" height=17><FONT face="Courier New" size=2>
      <P align=center>BAADF00D</FONT></P></TD>
    <TD width="8%" height=17><FONT face="Courier New" size=2>
      <P align=right>00000000</FONT></P></TD>
    <TD width="8%" height=17><FONT face="Courier New" size=2>
      <P align=right>77E10000</FONT></P></TD>
    <TD width="8%" height=17><FONT face="Courier New" size=2>
      <P align=right>00057000</FONT></P></TD>
    <TD width="9%" height=17><FONT face="Courier New" size=2>
      <P align=center>000C4006</FONT></P></TD>
    <TD width="6%" height=17><FONT face="Courier New" size=2>
      <P align=right>006</FONT></P></TD>
    <TD width="6%" height=17><FONT face="Courier New" size=2>
      <P align=right>0003</FONT></P></TD>
    <TD width="6%" height=17><FONT face="Courier New" size=2>
      <P align=right>65535</FONT></P></TD></TR></TABLE>

<BR><BR>

<DIV CLASS="Require">Requirements:</DIV>
<DD CLASS="req" >Library: <STRONG>ntdll.lib</STRONG>


<BR><BR><BR><BR>
<DIV CLASS="Require">See also:</DIV>
<A href="../../Structures/SYSTEM_MODULE.html">SYSTEM_MODULE</A><BR>
<A href="../../Structures/SYSTEM_MODULE_INFORMATION.html">SYSTEM_MODULE_INFORMATION</A><BR></DD>



<HR WIDTH="0" SIZE="0" NOSHADE CLASS="page">

</BODY>

<!-- Mirrored from undocumented.ntinternals.net/UserMode/Undocumented Functions/Executable Images/LdrQueryProcessModuleInformation.html by HTTrack Website Copier/3.x [XR&CO'2010], Sat, 24 Apr 2010 18:23:35 GMT -->
</HTML>

