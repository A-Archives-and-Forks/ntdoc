<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="description" content="TOKEN_INFORMATION_CLASS - NtDoc, the native NT API online documentation">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>TOKEN_INFORMATION_CLASS - NtDoc</title>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="manifest" href="icons/site.webmanifest">
    <link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="msapplication-config" content="icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <noscript id="dark-mode-toggle-stylesheets">
        <link rel="stylesheet" href="modules/water-2.1.1-light.css" media="(prefers-color-scheme: light)">
        <link rel="stylesheet" href="modules/water-2.1.1-dark.css" media="(prefers-color-scheme: dark)">
    </noscript>
    <script src="dark-mode-toggle-stylesheets-loader.min.js"></script>
    <link rel="stylesheet" href="modules/virtual-select/virtual-select.css">
    <link rel="stylesheet" href="modules/pygments-css.css">
    <link rel="stylesheet" href="ntdoc.css">
    <noscript>
        <link rel="stylesheet" href="ntdoc-noscript.css">
    </noscript>
</head>
<body>
    <header>
        <a href="."><img class="ntdoc-title-logo" src="logo.png" alt="logo"></a>
        <h1 class="ntdoc-title">
            TOKEN_INFORMATION_CLASS - NtDoc
        </h1>
        <div class="ntdoc-subtitle">
            Native API online documentation, based on the System Informer
            (formerly Process Hacker) <a target="_blank"
            href="https://github.com/winsiderss/systeminformer/tree/master/phnt">phnt
            headers</a>
        </div>
        <div id="ntdoc-search-select"></div>
    </header>
    <div class="ntdoc-code-elements">
<div class="ntdoc-code-element">
<pre class="ntdoc-code-pre"><code class="ntdoc-code"><span class="ntdoc-code-header">#ifndef _NTSEAPI_H
// Authz
// begin_rev
#if (PHNT_MODE == PHNT_MODE_KERNEL)

</span><span class="ntdoc-code-intro"></span><span class="ntdoc-code-body">typedef enum _TOKEN_INFORMATION_CLASS
{
    TokenUser = 1, // q: TOKEN_USER, SE_TOKEN_USER
    TokenGroups, // q: TOKEN_GROUPS
    TokenPrivileges, // q: TOKEN_PRIVILEGES
    TokenOwner, // q; s: TOKEN_OWNER
    TokenPrimaryGroup, // q; s: TOKEN_PRIMARY_GROUP
    TokenDefaultDacl, // q; s: TOKEN_DEFAULT_DACL
    TokenSource, // q: TOKEN_SOURCE
    TokenType, // q: TOKEN_TYPE
    TokenImpersonationLevel, // q: SECURITY_IMPERSONATION_LEVEL
    TokenStatistics, // q: TOKEN_STATISTICS // 10
    TokenRestrictedSids, // q: TOKEN_GROUPS
    TokenSessionId, // q; s: ULONG (requires SeTcbPrivilege)
    TokenGroupsAndPrivileges, // q: TOKEN_GROUPS_AND_PRIVILEGES
    TokenSessionReference, // s: ULONG (requires SeTcbPrivilege)
    TokenSandBoxInert, // q: ULONG
    TokenAuditPolicy, // q; s: TOKEN_AUDIT_POLICY (requires SeSecurityPrivilege/SeTcbPrivilege)
    TokenOrigin, // q; s: TOKEN_ORIGIN (requires SeTcbPrivilege)
    TokenElevationType, // q: TOKEN_ELEVATION_TYPE
    TokenLinkedToken, // q; s: TOKEN_LINKED_TOKEN (requires SeCreateTokenPrivilege)
    TokenElevation, // q: TOKEN_ELEVATION // 20
    TokenHasRestrictions, // q: ULONG
    TokenAccessInformation, // q: TOKEN_ACCESS_INFORMATION
    TokenVirtualizationAllowed, // q; s: ULONG (requires SeCreateTokenPrivilege)
    TokenVirtualizationEnabled, // q; s: ULONG
    TokenIntegrityLevel, // q; s: TOKEN_MANDATORY_LABEL
    TokenUIAccess, // q; s: ULONG (requires SeTcbPrivilege)
    TokenMandatoryPolicy, // q; s: TOKEN_MANDATORY_POLICY (requires SeTcbPrivilege)
    TokenLogonSid, // q: TOKEN_GROUPS
    TokenIsAppContainer, // q: ULONG // since WIN8
    TokenCapabilities, // q: TOKEN_GROUPS // 30
    TokenAppContainerSid, // q: TOKEN_APPCONTAINER_INFORMATION
    TokenAppContainerNumber, // q: ULONG
    TokenUserClaimAttributes, // q: CLAIM_SECURITY_ATTRIBUTES_INFORMATION
    TokenDeviceClaimAttributes, // q: CLAIM_SECURITY_ATTRIBUTES_INFORMATION
    TokenRestrictedUserClaimAttributes, // q: CLAIM_SECURITY_ATTRIBUTES_INFORMATION
    TokenRestrictedDeviceClaimAttributes, // q: CLAIM_SECURITY_ATTRIBUTES_INFORMATION
    TokenDeviceGroups, // q: TOKEN_GROUPS
    TokenRestrictedDeviceGroups, // q: TOKEN_GROUPS
    TokenSecurityAttributes, // q; s: TOKEN_SECURITY_ATTRIBUTES_[AND_OPERATION_]INFORMATION (requires SeTcbPrivilege)
    TokenIsRestricted, // q: ULONG // 40
    TokenProcessTrustLevel, // q: <a href="token_process_trust_level" title="typedef struct _TOKEN_PROCESS_TRUST_LEVEL&#10;{&#10;    PSID TrustLevelSid;&#10;} TOKEN_PROCESS_TRUST_LEVEL, *PTOKEN_PROCESS_TRUST_LEVEL;">TOKEN_PROCESS_TRUST_LEVEL</a> // since WINBLUE
    TokenPrivateNameSpace, // q; s: ULONG  (requires SeTcbPrivilege) // since THRESHOLD
    TokenSingletonAttributes, // q: <a href="token_security_attributes_information" title="typedef struct _TOKEN_SECURITY_ATTRIBUTES_INFORMATION&#10;{&#10;    USHORT Version;&#10;    USHORT Reserved;&#10;    ULONG AttributeCount;&#10;    union&#10;    {&#10;        PTOKEN_SECURITY_ATTRIBUTE_V1 pAttributeV1;&#10;    } Attribute;&#10;} TOKEN_SECURITY_ATTRIBUTES_INFORMATION, *PTOKEN_SECURITY_ATTRIBUTES_INFORMATION;">TOKEN_SECURITY_ATTRIBUTES_INFORMATION</a> // since REDSTONE
    TokenBnoIsolation, // q: TOKEN_BNO_ISOLATION_INFORMATION // since REDSTONE2
    TokenChildProcessFlags, // s: ULONG  (requires SeTcbPrivilege) // since REDSTONE3
    TokenIsLessPrivilegedAppContainer, // q: ULONG // since REDSTONE5
    TokenIsSandboxed, // q: ULONG // since 19H1
    TokenIsAppSilo, // q: ULONG // since WIN11 22H2 // previously TokenOriginatingProcessTrustLevel // q: <a href="token_process_trust_level" title="typedef struct _TOKEN_PROCESS_TRUST_LEVEL&#10;{&#10;    PSID TrustLevelSid;&#10;} TOKEN_PROCESS_TRUST_LEVEL, *PTOKEN_PROCESS_TRUST_LEVEL;">TOKEN_PROCESS_TRUST_LEVEL</a>
    MaxTokenInfoClass
} TOKEN_INFORMATION_CLASS, *PTOKEN_INFORMATION_CLASS;
</span><span class="ntdoc-code-footer">
#endif
// end_rev
#endif
</span><span class="ntdoc-code-links"><hr><a target="_blank" href="https://github.com/winsiderss/systeminformer/blob/7ad60587c3a0af08f2bf26131d1405b8f561145b/phnt/include/ntseapi.h#L56">View code on GitHub</a></span></code></pre></div>
</div>
<div class="ntdoc-description">
<p>This enumeration defines types of information that can be queried or set for tokens. The enumeration is partially documented <a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows-hardware/drivers/ddi/ntifs/ne-ntifs-_token_information_class">in Windows Driver Kit</a> and <a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/winnt/ne-winnt-token_information_class">in Windows SDK</a>.</p>

<h1 id="applicable-to">Applicable to</h1>

<ul>
<li><code><a href="ntqueryinformationthread" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtQueryInformationThread(&#10;    _In_ HANDLE ThreadHandle,&#10;    _In_ THREADINFOCLASS ThreadInformationClass,&#10;    _Out_writes_bytes_(ThreadInformationLength) PVOID ThreadInformation,&#10;    _In_ ULONG ThreadInformationLength,&#10;    _Out_opt_ PULONG ReturnLength&#10;    );">NtQueryInformationThread</a></code></li>
<li><code><a href="ntsetinformationthread" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtSetInformationThread(&#10;    _In_ HANDLE ThreadHandle,&#10;    _In_ THREADINFOCLASS ThreadInformationClass,&#10;    _In_reads_bytes_(ThreadInformationLength) PVOID ThreadInformation,&#10;    _In_ ULONG ThreadInformationLength&#10;    );">NtSetInformationThread</a></code></li>
</ul>

<h1 id="members">Members</h1>

<h2 id="tokenuser-1">TokenUser (1)</h2>

<p>Retrieves the user SID associated with the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_USER</code> or <code>SE_TOKEN_USER</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="remarks">Remarks</h3>

<p>The user SID is considered enabled for granting access checks when its attributes don't include the <code>SE_GROUP_USE_FOR_DENY_ONLY</code> flag. Note that this behavior differs from token groups which explicitly require <code>SE_GROUP_ENABLED</code> flag to be set. In other words, an enabled user has attributes set to zero; a filtered/disabled user (see <code><a href="ntfiltertoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterToken</a></code>) has attributes set to <code>SE_GROUP_USE_FOR_DENY_ONLY</code>.</p>

<h2 id="tokengroups-2">TokenGroups (2)</h2>

<p>Retrieves the list of SIDs (group membership) associated with the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_GROUPS</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="remarks-2">Remarks</h3>

<p>A group SID is considered enabled for granting access checks when its attributes include <code>SE_GROUP_ENABLED</code>. A group SID is considered enabled for denying access checks when its attributes include either <code>SE_GROUP_ENABLED</code> or <code>SE_GROUP_USE_FOR_DENY_ONLY</code>.</p>

<h3 id="see-also">See also</h3>

<ul>
<li><code><a href="ntfiltertoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterToken</a></code></li>
<li><code><a href="ntadjustgroupstoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtAdjustGroupsToken(&#10;    _In_ HANDLE TokenHandle,&#10;    _In_ BOOLEAN ResetToDefault,&#10;    _In_opt_ PTOKEN_GROUPS NewState,&#10;    _In_opt_ ULONG BufferLength,&#10;    _Out_writes_bytes_to_opt_(BufferLength, *ReturnLength) PTOKEN_GROUPS PreviousState,&#10;    _Out_opt_ PULONG ReturnLength&#10;    );">NtAdjustGroupsToken</a></code></li>
</ul>

<h2 id="tokenprivileges-3">TokenPrivileges (3)</h2>

<p>Retrieves the list of privileges present in the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_PRIVILEGES</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="remarks-3">Remarks</h3>

<p>A privilege is considered enabled for access checks when its attributes include <code>SE_PRIVILEGE_ENABLED</code>.</p>

<h3 id="see-also-2">See also</h3>

<ul>
<li><code><a href="ntfiltertoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterToken</a></code></li>
<li><code><a href="ntadjustprivilegestoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtAdjustPrivilegesToken(&#10;    _In_ HANDLE TokenHandle,&#10;    _In_ BOOLEAN DisableAllPrivileges,&#10;    _In_opt_ PTOKEN_PRIVILEGES NewState,&#10;    _In_ ULONG BufferLength,&#10;    _Out_writes_bytes_to_opt_(BufferLength, *ReturnLength) PTOKEN_PRIVILEGES PreviousState,&#10;    _Out_opt_ PULONG ReturnLength&#10;    );">NtAdjustPrivilegesToken</a></code></li>
</ul>

<h2 id="tokenowner-4">TokenOwner (4)</h2>

<p>Retrieves or sets the default owner SID for newly created objects.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_OWNER</code></td>
  <td><code>TOKEN_OWNER</code></td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
</tbody>
</table>

<h3 id="remarks-4">Remarks</h3>

<p>When changing the value, the provided SID must be either the user of the token or one of the groups that have the <code>SE_GROUP_OWNER</code> flag. Otherwise, the request fails with <code>STATUS_INVALID_OWNER</code>.</p>

<h3 id="see-also-3">See also</h3>

<ul>
<li><code><a href="rtlgetownersecuritydescriptor" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlGetOwnerSecurityDescriptor(&#10;    _In_ PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _Outptr_result_maybenull_ PSID *Owner,&#10;    _Out_ PBOOLEAN OwnerDefaulted&#10;    );">RtlGetOwnerSecurityDescriptor</a></code></li>
<li><code><a href="rtlsetownersecuritydescriptor" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlSetOwnerSecurityDescriptor(&#10;    _Inout_ PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _In_opt_ PSID Owner,&#10;    _In_ BOOLEAN OwnerDefaulted&#10;    );">RtlSetOwnerSecurityDescriptor</a></code></li>
</ul>

<h2 id="tokenprimarygroup-5">TokenPrimaryGroup (5)</h2>

<p>Retrieves or sets the default primary group SID for newly created objects.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_PRIMARY_GROUP</code></td>
  <td><code>TOKEN_PRIMARY_GROUP</code></td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
</tbody>
</table>

<h3 id="remarks-5">Remarks</h3>

<p>When changing the value, the provided SID must be either the user or one of the groups of the token. Otherwise, the request fails with <code>STATUS_INVALID_PRIMARY_GROUP</code>.</p>

<h3 id="see-also-4">See also</h3>

<ul>
<li><code><a href="rtlgetgroupsecuritydescriptor" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlGetGroupSecurityDescriptor(&#10;    _In_ PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _Outptr_result_maybenull_ PSID *Group,&#10;    _Out_ PBOOLEAN GroupDefaulted&#10;    );">RtlGetGroupSecurityDescriptor</a></code></li>
<li><code><a href="rtlsetgroupsecuritydescriptor" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlSetGroupSecurityDescriptor(&#10;    _Inout_ PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _In_opt_ PSID Group,&#10;    _In_ BOOLEAN GroupDefaulted&#10;    );">RtlSetGroupSecurityDescriptor</a></code></li>
</ul>

<h2 id="tokendefaultdacl-6">TokenDefaultDacl (6)</h2>

<p>Retrieves or sets the default discretionary ACL (DACL) for newly created objects.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_DEFAULT_DACL</code></td>
  <td><code>TOKEN_DEFAULT_DACL</code></td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
</tbody>
</table>

<h3 id="see-also-5">See also</h3>

<ul>
<li><code><a href="rtlgetdaclsecuritydescriptor" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlGetDaclSecurityDescriptor(&#10;    _In_ PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _Out_ PBOOLEAN DaclPresent,&#10;    _Outptr_result_maybenull_ PACL *Dacl,&#10;    _Out_ PBOOLEAN DaclDefaulted&#10;    );">RtlGetDaclSecurityDescriptor</a></code></li>
<li><code><a href="rtlsetdaclsecuritydescriptor" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlSetDaclSecurityDescriptor(&#10;    _Inout_ PSECURITY_DESCRIPTOR SecurityDescriptor,&#10;    _In_ BOOLEAN DaclPresent,&#10;    _In_opt_ PACL Dacl,&#10;    _In_ BOOLEAN DaclDefaulted&#10;    );">RtlSetDaclSecurityDescriptor</a></code></li>
</ul>

<h2 id="tokensource-7">TokenSource (7)</h2>

<p>Retrieves the string and LUID that identify the source of the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_SOURCE</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY_SOURCE</code></td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="see-also-6">See also</h3>

<ul>
<li><code><a href="ntcreatetoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateToken(&#10;    _Out_ PHANDLE TokenHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_opt_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_ TOKEN_TYPE Type,&#10;    _In_ PLUID AuthenticationId,&#10;    _In_ PLARGE_INTEGER ExpirationTime,&#10;    _In_ PTOKEN_USER User,&#10;    _In_ PTOKEN_GROUPS Groups,&#10;    _In_ PTOKEN_PRIVILEGES Privileges,&#10;    _In_opt_ PTOKEN_OWNER Owner,&#10;    _In_ PTOKEN_PRIMARY_GROUP PrimaryGroup,&#10;    _In_opt_ PTOKEN_DEFAULT_DACL DefaultDacl,&#10;    _In_ PTOKEN_SOURCE Source&#10;    );">NtCreateToken</a></code></li>
</ul>

<h2 id="tokentype-8">TokenType (8)</h2>

<p>Determines whether the token is a primary token or an impersonation token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_TYPE</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="see-also-7">See also</h3>

<ul>
<li><code><a href="ntduplicatetoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtDuplicateToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_opt_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_ BOOLEAN EffectiveOnly,&#10;    _In_ TOKEN_TYPE Type,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtDuplicateToken</a></code></li>
</ul>

<h2 id="tokenimpersonationlevel-9">TokenImpersonationLevel (9)</h2>

<p>Retrieves the level of impersonation for impersonation-type tokens.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>SECURITY_IMPERSONATION_LEVEL</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="see-also-8">See also</h3>

<ul>
<li><code><a href="ntduplicatetoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtDuplicateToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_opt_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_ BOOLEAN EffectiveOnly,&#10;    _In_ TOKEN_TYPE Type,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtDuplicateToken</a></code></li>
</ul>

<h2 id="tokenstatistics-10">TokenStatistics (10)</h2>

<p>Retrieves various statistics information for the token such its type, the number of groups and privileges, and the associated logon session LUID.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_STATISTICS</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h2 id="tokenrestrictedsids-11">TokenRestrictedSids (11)</h2>

<p>Retrieves the list of restricting groups for the secondary access check added via <code><a href="ntfiltertoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterToken</a></code>.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_GROUPS</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="see-also-9">See also</h3>

<ul>
<li><code><a href="ntfiltertoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterToken</a></code></li>
</ul>

<h2 id="tokensessionid-12">TokenSessionId (12)</h2>

<p>Retrieves or sets the session ID of the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>ULONG</code></td>
  <td><code>ULONG</code></td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td><code>TOKEN_ADJUST_DEFAULT | TOKEN_ADJUST_SESSIONID</code></td>
</tr>
<tr>
  <td>Required privilege</td>
  <td>None</td>
  <td><code>SeTcbPrivilege</code></td>
</tr>
</tbody>
</table>

<h3 id="remarks-6">Remarks</h3>

<p>Attempting to change the session ID of a token that is assigned as a primary process token results in <code>STATUS_TOKEN_ALREADY_IN_USE</code>.</p>

<h2 id="tokengroupsandprivileges-13">TokenGroupsAndPrivileges (13)</h2>

<p>Retrieves the list of SIDs, restricting SIDs, and privileges present in the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_GROUPS_AND_PRIVILEGES</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="see-also-10">See also</h3>

<ul>
<li><code><a href="ntfiltertoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterToken</a></code></li>
<li><code><a href="ntadjustprivilegestoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtAdjustPrivilegesToken(&#10;    _In_ HANDLE TokenHandle,&#10;    _In_ BOOLEAN DisableAllPrivileges,&#10;    _In_opt_ PTOKEN_PRIVILEGES NewState,&#10;    _In_ ULONG BufferLength,&#10;    _Out_writes_bytes_to_opt_(BufferLength, *ReturnLength) PTOKEN_PRIVILEGES PreviousState,&#10;    _Out_opt_ PULONG ReturnLength&#10;    );">NtAdjustPrivilegesToken</a></code></li>
<li><code><a href="ntadjustgroupstoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtAdjustGroupsToken(&#10;    _In_ HANDLE TokenHandle,&#10;    _In_ BOOLEAN ResetToDefault,&#10;    _In_opt_ PTOKEN_GROUPS NewState,&#10;    _In_opt_ ULONG BufferLength,&#10;    _Out_writes_bytes_to_opt_(BufferLength, *ReturnLength) PTOKEN_GROUPS PreviousState,&#10;    _Out_opt_ PULONG ReturnLength&#10;    );">NtAdjustGroupsToken</a></code></li>
</ul>

<h2 id="tokensessionreference-14">TokenSessionReference (14)</h2>

<p>Allows releasing token's reference to the associated logon session.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td>N/A</td>
  <td><code>ULONG</code> (<code>0</code>) or <code>BOOL</code> (<code>FALSE</code>)</td>
</tr>
<tr>
  <td>Required access</td>
  <td>N/A</td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required privilege</td>
  <td>None</td>
  <td><code>SeTcbPrivilege</code></td>
</tr>
</tbody>
</table>

<h2 id="tokensandboxinert-15">TokenSandBoxInert (15)</h2>

<p>Retrieves whether the token allows bypassing Software Restriction Policies and AppLocker rules. This info class checks for the <code>TOKEN_SANDBOX_INERT</code> token flag.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>ULONG</code> or <code>BOOL</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="see-also-11">See also</h3>

<ul>
<li><code><a href="ntfiltertoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterToken</a></code></li>
</ul>

<h2 id="tokenauditpolicy-16">TokenAuditPolicy (16)</h2>

<p>Retrieves and sets the per-user audit policy overrides for the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_AUDIT_POLICY</code></td>
  <td><code>TOKEN_AUDIT_POLICY</code></td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
<tr>
  <td>Required privilege</td>
  <td><code>SeSecurityPrivilege</code></td>
  <td><code>SeTcbPrivilege</code></td>
</tr>
</tbody>
</table>

<h3 id="remarks-7">Remarks</h3>

<p>Audit policy overrides can only be set once per token. Subsequent attempts to modify this information result in <code>STATUS_INVALID_PARAMETER</code>.</p>

<h2 id="tokenorigin-17">TokenOrigin (17)</h2>

<p>Retrieves and adjusts the LUID of the originating logon session for the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_ORIGIN</code></td>
  <td><code>TOKEN_ORIGIN</code></td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
<tr>
  <td>Required privilege</td>
  <td>None</td>
  <td><code>SeTcbPrivilege</code></td>
</tr>
</tbody>
</table>

<h3 id="related-win32-api">Related Win32 API</h3>

<ul>
<li><a rel="noopener" target="_blank" href="https://learn.microsoft.com/en-us/windows/win32/api/ntsecapi/nf-ntsecapi-lsalogonuser"><code>LsaLogonUser</code></a></li>
</ul>

<h2 id="tokenelevationtype-18">TokenElevationType (18)</h2>

<p>Determines the elevation type of the logon session associated with the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_ELEVATION_TYPE</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="remarks-8">Remarks</h3>

<p>This information is not per se a property of the token but rather its logon session.</p>

<h2 id="tokenlinkedtoken-19">TokenLinkedToken (19)</h2>

<p>Opens a copy of a token from the linked logon session or links logon sessions of the two tokens.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_LINKED_TOKEN</code></td>
  <td><code>TOKEN_LINKED_TOKEN</code></td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td><code>TOKEN_ADJUST_DEFAULT | TOKEN_QUERY</code> (on both handles)</td>
</tr>
<tr>
  <td>Required privilege</td>
  <td>None</td>
  <td><code>SeCreateTokenPrivilege</code></td>
</tr>
</tbody>
</table>

<h3 id="remarks-9">Remarks</h3>

<p>Querying this information class returns a primary token when the caller has <code>SeTcbPrivilege</code> enabled and an identification-level token otherwise.</p>

<p>Settings linked token requires both tokens to be primary and belong to logon sessions that are not already linked. The token passed in the first parameter to <code><a href="ntsetinformationtoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtSetInformationToken(&#10;    _In_ HANDLE TokenHandle,&#10;    _In_ TOKEN_INFORMATION_CLASS TokenInformationClass,&#10;    _In_reads_bytes_(TokenInformationLength) PVOID TokenInformation,&#10;    _In_ ULONG TokenInformationLength&#10;    );">NtSetInformationToken</a></code> provides the logon session to be marked as elevated while the token passed via the buffer becomes the limited logon session.</p>

<h2 id="tokenelevation-20">TokenElevation (20)</h2>

<p>Determines whether the token is elevated by checking if it contains any sensitive groups (see <code><a href="rtliselevatedrid" title="NTSYSAPI&#10;BOOLEAN&#10;NTAPI&#10;RtlIsElevatedRid(&#10;    _In_ PSID_AND_ATTRIBUTES SidAttr&#10;    );">RtlIsElevatedRid</a></code>) or privileges.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_ELEVATION</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h2 id="tokenhasrestrictions-21">TokenHasRestrictions (21)</h2>

<p>Determines whether the token has been filtered via <code><a href="ntfiltertoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterToken</a></code>. This info class checks token flags for <code>TOKEN_IS_RESTRICTED | TOKEN_IS_FILTERED</code>.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>ULONG</code> or <code>BOOL</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="see-also-12">See also</h3>

<ul>
<li><code><a href="ntfiltertoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterToken</a></code></li>
</ul>

<h2 id="tokenaccessinformation-22">TokenAccessInformation (22)</h2>

<p>Retrieves various access-related information such as the SID hashes, privileges, and token flags.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_ACCESS_INFORMATION</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h2 id="tokenvirtualizationallowed-23">TokenVirtualizationAllowed (23)</h2>

<p>Retrieves or sets whether the token allows enabling UAC filesystem and registry virtualization. This info class accesses the <code>TOKEN_VIRTUALIZE_ALLOWED</code> token flag.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>ULONG</code> or <code>BOOL</code></td>
  <td><code>ULONG</code> or <code>BOOL</code></td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
<tr>
  <td>Required privilege</td>
  <td>None</td>
  <td><code>SeCreateTokenPrivilege</code></td>
</tr>
</tbody>
</table>

<h2 id="tokenvirtualizationenabled-24">TokenVirtualizationEnabled (24)</h2>

<p>Retrieves or sets whether UAC filesystem and registry virtualization is enabled for the token. This info class accesses the <code>TOKEN_VIRTUALIZE_ENABLED</code> token flag.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>ULONG</code> or <code>BOOL</code></td>
  <td><code>ULONG</code> or <code>BOOL</code></td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
</tbody>
</table>

<h2 id="tokenintegritylevel-25">TokenIntegrityLevel (25)</h2>

<p>Retrieves or changes the integrity level of the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_MANDATORY_LABEL</code></td>
  <td><code>TOKEN_MANDATORY_LABEL</code></td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
<tr>
  <td>Required privilege</td>
  <td>None</td>
  <td>None to lower; <code>SeTcbPrivilege</code> to raise</td>
</tr>
</tbody>
</table>

<h3 id="remarks-10">Remarks</h3>

<p>Attempting to raise integrity level of a token that is assigned as a primary process token results in <code>STATUS_TOKEN_ALREADY_IN_USE</code>.</p>

<p>Lowering integrity automatically disables incompatible privileges and prevents them from being enabled.</p>

<h2 id="tokenuiaccess-26">TokenUIAccess (26)</h2>

<p>Retrieves or sets whether the token allows bypassing User Interface Privilege Isolation (UIPI). This info class accesses the <code>TOKEN_UIACCESS</code> token flag.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>ULONG</code> or <code>BOOL</code></td>
  <td><code>ULONG</code> or <code>BOOL</code></td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
<tr>
  <td>Required privilege</td>
  <td>None</td>
  <td>None to disable; <code>SeTcbPrivilege</code> to enable</td>
</tr>
</tbody>
</table>

<h2 id="tokenmandatorypolicy-27">TokenMandatoryPolicy (27)</h2>

<p>Retrieves or sets mandatory policy for the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_MANDATORY_POLICY</code></td>
  <td><code>TOKEN_MANDATORY_POLICY</code></td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
<tr>
  <td>Required privilege</td>
  <td>None</td>
  <td><code>SeTcbPrivilege</code></td>
</tr>
</tbody>
</table>

<h3 id="remarks-11">Remarks</h3>

<p>Attempting to change mandatory policy of a token that is assigned as a primary process token results in <code>STATUS_TOKEN_ALREADY_IN_USE</code>.</p>

<h2 id="tokenlogonsid-28">TokenLogonSid (28)</h2>

<p>Finds (the first) logon SID (a group with <code>SE_GROUP_LOGON_ID</code> flag) in the list of token groups.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_GROUPS</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h2 id="tokenisappcontainer-29">TokenIsAppContainer (29)</h2>

<p>Determines whether the token is an AppContainer/LowBox token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>ULONG</code> or <code>BOOL</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Minimal version</td>
  <td>Windows 8</td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="remarks-12">Remarks</h3>

<p>AppContainer tokens perform an additional access check against the corresponding AppContainer SID, <code>ALL APPLICATION PACKAGES</code> SID (<code>S-1-15-2-1</code>), and the list of provided capabilities.</p>

<h3 id="see-also-13">See also</h3>

<ul>
<li><code><a href="ntcreatelowboxtoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateLowBoxToken(&#10;    _Out_ PHANDLE TokenHandle,&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_opt_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_ PSID PackageSid,&#10;    _In_ ULONG CapabilityCount,&#10;    _In_reads_opt_(CapabilityCount) PSID_AND_ATTRIBUTES Capabilities,&#10;    _In_ ULONG HandleCount,&#10;    _In_reads_opt_(HandleCount) HANDLE *Handles&#10;    );">NtCreateLowBoxToken</a></code></li>
</ul>

<h2 id="tokencapabilities-30">TokenCapabilities (30)</h2>

<p>Retrieves the list of capability SIDs associated with the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_GROUPS</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Minimal version</td>
  <td>Windows 8</td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="see-also-14">See also</h3>

<ul>
<li><code><a href="ntcreatelowboxtoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateLowBoxToken(&#10;    _Out_ PHANDLE TokenHandle,&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_opt_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_ PSID PackageSid,&#10;    _In_ ULONG CapabilityCount,&#10;    _In_reads_opt_(CapabilityCount) PSID_AND_ATTRIBUTES Capabilities,&#10;    _In_ ULONG HandleCount,&#10;    _In_reads_opt_(HandleCount) HANDLE *Handles&#10;    );">NtCreateLowBoxToken</a></code></li>
</ul>

<h2 id="tokenappcontainersid-31">TokenAppContainerSid (31)</h2>

<p>Retrieves the AppContainer/Package SID associated with a LowBox token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_APPCONTAINER_INFORMATION</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Minimal version</td>
  <td>Windows 8</td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="remarks-13">Remarks</h3>

<p>AppContainer tokens perform an additional access check against the AppContainer SID, <code>ALL APPLICATION PACKAGES</code> SID (<code>S-1-15-2-1</code>), and the list of provided capabilities.</p>

<h3 id="see-also-15">See also</h3>

<ul>
<li><code><a href="ntcreatelowboxtoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateLowBoxToken(&#10;    _Out_ PHANDLE TokenHandle,&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_opt_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_ PSID PackageSid,&#10;    _In_ ULONG CapabilityCount,&#10;    _In_reads_opt_(CapabilityCount) PSID_AND_ATTRIBUTES Capabilities,&#10;    _In_ ULONG HandleCount,&#10;    _In_reads_opt_(HandleCount) HANDLE *Handles&#10;    );">NtCreateLowBoxToken</a></code></li>
</ul>

<h2 id="tokenappcontainernumber-32">TokenAppContainerNumber (32)</h2>

<p>Retrieves the token AppContainer/LowBox number.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>ULONG</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Minimal version</td>
  <td>Windows 8</td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h2 id="tokenuserclaimattributes-33">TokenUserClaimAttributes (33)</h2>

<p>Retrieves the list of user claim attributes associated with the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>CLAIM_SECURITY_ATTRIBUTES_INFORMATION</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Minimal version</td>
  <td>Windows 8</td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="see-also-16">See also</h3>

<ul>
<li><code><a href="ntcreatetokenex" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateTokenEx(&#10;    _Out_ PHANDLE TokenHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_opt_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_ TOKEN_TYPE Type,&#10;    _In_ PLUID AuthenticationId,&#10;    _In_ PLARGE_INTEGER ExpirationTime,&#10;    _In_ PTOKEN_USER User,&#10;    _In_ PTOKEN_GROUPS Groups,&#10;    _In_ PTOKEN_PRIVILEGES Privileges,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION UserAttributes,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION DeviceAttributes,&#10;    _In_opt_ PTOKEN_GROUPS DeviceGroups,&#10;    _In_opt_ PTOKEN_MANDATORY_POLICY MandatoryPolicy,&#10;    _In_opt_ PTOKEN_OWNER Owner,&#10;    _In_ PTOKEN_PRIMARY_GROUP PrimaryGroup,&#10;    _In_opt_ PTOKEN_DEFAULT_DACL DefaultDacl,&#10;...">NtCreateTokenEx</a></code></li>
</ul>

<h2 id="tokendeviceclaimattributes-34">TokenDeviceClaimAttributes (34)</h2>

<p>Retrieves the list of device claim attributes associated with the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>CLAIM_SECURITY_ATTRIBUTES_INFORMATION</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Minimal version</td>
  <td>Windows 8</td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="see-also-17">See also</h3>

<ul>
<li><code><a href="ntcreatetokenex" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateTokenEx(&#10;    _Out_ PHANDLE TokenHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_opt_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_ TOKEN_TYPE Type,&#10;    _In_ PLUID AuthenticationId,&#10;    _In_ PLARGE_INTEGER ExpirationTime,&#10;    _In_ PTOKEN_USER User,&#10;    _In_ PTOKEN_GROUPS Groups,&#10;    _In_ PTOKEN_PRIVILEGES Privileges,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION UserAttributes,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION DeviceAttributes,&#10;    _In_opt_ PTOKEN_GROUPS DeviceGroups,&#10;    _In_opt_ PTOKEN_MANDATORY_POLICY MandatoryPolicy,&#10;    _In_opt_ PTOKEN_OWNER Owner,&#10;    _In_ PTOKEN_PRIMARY_GROUP PrimaryGroup,&#10;    _In_opt_ PTOKEN_DEFAULT_DACL DefaultDacl,&#10;...">NtCreateTokenEx</a></code></li>
</ul>

<h2 id="tokenrestricteduserclaimattributes-35">TokenRestrictedUserClaimAttributes (35)</h2>

<p>Retrieves the list of restricted user claim attributes associated with the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>CLAIM_SECURITY_ATTRIBUTES_INFORMATION</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Minimal version</td>
  <td>Windows 8</td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="see-also-18">See also</h3>

<ul>
<li><code><a href="ntfiltertokenex" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterTokenEx(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _In_ ULONG DisableUserClaimsCount,&#10;    _In_opt_ PUNICODE_STRING UserClaimsToDisable,&#10;    _In_ ULONG DisableDeviceClaimsCount,&#10;    _In_opt_ PUNICODE_STRING DeviceClaimsToDisable,&#10;    _In_opt_ PTOKEN_GROUPS DeviceGroupsToDisable,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION RestrictedUserAttributes,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION RestrictedDeviceAttributes,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedDeviceGroups,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterTokenEx</a></code></li>
</ul>

<h2 id="tokenrestricteddeviceclaimattributes-36">TokenRestrictedDeviceClaimAttributes (36)</h2>

<p>Retrieves the list of restricted device claim attributes associated with the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>CLAIM_SECURITY_ATTRIBUTES_INFORMATION</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Minimal version</td>
  <td>Windows 8</td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="see-also-19">See also</h3>

<ul>
<li><code><a href="ntfiltertokenex" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterTokenEx(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _In_ ULONG DisableUserClaimsCount,&#10;    _In_opt_ PUNICODE_STRING UserClaimsToDisable,&#10;    _In_ ULONG DisableDeviceClaimsCount,&#10;    _In_opt_ PUNICODE_STRING DeviceClaimsToDisable,&#10;    _In_opt_ PTOKEN_GROUPS DeviceGroupsToDisable,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION RestrictedUserAttributes,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION RestrictedDeviceAttributes,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedDeviceGroups,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterTokenEx</a></code></li>
</ul>

<h2 id="tokendevicegroups-37">TokenDeviceGroups (37)</h2>

<p>Retrieves the list of device group SIDs device claim attributes associated with the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_GROUPS</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Minimal version</td>
  <td>Windows 8</td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="see-also-20">See also</h3>

<ul>
<li><code><a href="ntcreatetokenex" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtCreateTokenEx(&#10;    _Out_ PHANDLE TokenHandle,&#10;    _In_ ACCESS_MASK DesiredAccess,&#10;    _In_opt_ POBJECT_ATTRIBUTES ObjectAttributes,&#10;    _In_ TOKEN_TYPE Type,&#10;    _In_ PLUID AuthenticationId,&#10;    _In_ PLARGE_INTEGER ExpirationTime,&#10;    _In_ PTOKEN_USER User,&#10;    _In_ PTOKEN_GROUPS Groups,&#10;    _In_ PTOKEN_PRIVILEGES Privileges,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION UserAttributes,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION DeviceAttributes,&#10;    _In_opt_ PTOKEN_GROUPS DeviceGroups,&#10;    _In_opt_ PTOKEN_MANDATORY_POLICY MandatoryPolicy,&#10;    _In_opt_ PTOKEN_OWNER Owner,&#10;    _In_ PTOKEN_PRIMARY_GROUP PrimaryGroup,&#10;    _In_opt_ PTOKEN_DEFAULT_DACL DefaultDacl,&#10;...">NtCreateTokenEx</a></code></li>
</ul>

<h2 id="tokenrestricteddevicegroups-38">TokenRestrictedDeviceGroups (38)</h2>

<p>Retrieves the list of restricted device group SIDs device claim attributes associated with the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_GROUPS</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Minimal version</td>
  <td>Windows 8</td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="see-also-21">See also</h3>

<ul>
<li><code><a href="ntfiltertokenex" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterTokenEx(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _In_ ULONG DisableUserClaimsCount,&#10;    _In_opt_ PUNICODE_STRING UserClaimsToDisable,&#10;    _In_ ULONG DisableDeviceClaimsCount,&#10;    _In_opt_ PUNICODE_STRING DeviceClaimsToDisable,&#10;    _In_opt_ PTOKEN_GROUPS DeviceGroupsToDisable,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION RestrictedUserAttributes,&#10;    _In_opt_ PTOKEN_SECURITY_ATTRIBUTES_INFORMATION RestrictedDeviceAttributes,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedDeviceGroups,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterTokenEx</a></code></li>
</ul>

<h2 id="tokensecurityattributes-39">TokenSecurityAttributes (39)</h2>

<p>Retrieves or modifies the list of security attributes associated with the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code><a href="token_security_attributes_information" title="typedef struct _TOKEN_SECURITY_ATTRIBUTES_INFORMATION&#10;{&#10;    USHORT Version;&#10;    USHORT Reserved;&#10;    ULONG AttributeCount;&#10;    union&#10;    {&#10;        PTOKEN_SECURITY_ATTRIBUTE_V1 pAttributeV1;&#10;    } Attribute;&#10;} TOKEN_SECURITY_ATTRIBUTES_INFORMATION, *PTOKEN_SECURITY_ATTRIBUTES_INFORMATION;">TOKEN_SECURITY_ATTRIBUTES_INFORMATION</a></code></td>
  <td><code><a href="token_security_attributes_and_operation_information" title="typedef struct _TOKEN_SECURITY_ATTRIBUTES_AND_OPERATION_INFORMATION&#10;{&#10;    PTOKEN_SECURITY_ATTRIBUTES_INFORMATION Attributes;&#10;    PTOKEN_SECURITY_ATTRIBUTE_OPERATION Operations;&#10;} TOKEN_SECURITY_ATTRIBUTES_AND_OPERATION_INFORMATION, *PTOKEN_SECURITY_ATTRIBUTES_AND_OPERATION_INFORMATION;">TOKEN_SECURITY_ATTRIBUTES_AND_OPERATION_INFORMATION</a></code></td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
<tr>
  <td>Required privilege</td>
  <td>None</td>
  <td><code>SeTcbPrivilege</code></td>
</tr>
<tr>
  <td>Minimal version</td>
  <td>Windows 8</td>
  <td>Windows 8</td>
</tr>
</tbody>
</table>

<h3 id="see-also-22">See also</h3>

<ul>
<li><code><a href="ntquerysecurityattributestoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtQuerySecurityAttributesToken(&#10;    _In_ HANDLE TokenHandle,&#10;    _In_reads_opt_(NumberOfAttributes) PUNICODE_STRING Attributes,&#10;    _In_ ULONG NumberOfAttributes,&#10;    _Out_writes_bytes_(Length) PVOID Buffer, // PTOKEN_SECURITY_ATTRIBUTES_INFORMATION&#10;    _In_ ULONG Length,&#10;    _Out_ PULONG ReturnLength&#10;    );">NtQuerySecurityAttributesToken</a></code></li>
</ul>

<h2 id="tokenisrestricted-40">TokenIsRestricted (40)</h2>

<p>Determines if the token is restricted (i.e., requires a secondary access check against the list of restricting SIDs). This info class checks token flags for <code>TOKEN_IS_RESTRICTED | TOKEN_WRITE_RESTRICTED</code>.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>ULONG</code> or <code>BOOL</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Minimal version</td>
  <td>Windows 8</td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="see-also-23">See also</h3>

<ul>
<li><code><a href="ntfiltertoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtFilterToken(&#10;    _In_ HANDLE ExistingTokenHandle,&#10;    _In_ ULONG Flags,&#10;    _In_opt_ PTOKEN_GROUPS SidsToDisable,&#10;    _In_opt_ PTOKEN_PRIVILEGES PrivilegesToDelete,&#10;    _In_opt_ PTOKEN_GROUPS RestrictedSids,&#10;    _Out_ PHANDLE NewTokenHandle&#10;    );">NtFilterToken</a></code></li>
</ul>

<h2 id="tokenprocesstrustlevel-41">TokenProcessTrustLevel (41)</h2>

<p>Retrieves the process trust level (protection/PPL) SID associated with the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code><a href="token_process_trust_level" title="typedef struct _TOKEN_PROCESS_TRUST_LEVEL&#10;{&#10;    PSID TrustLevelSid;&#10;} TOKEN_PROCESS_TRUST_LEVEL, *PTOKEN_PROCESS_TRUST_LEVEL;">TOKEN_PROCESS_TRUST_LEVEL</a></code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Minimal version</td>
  <td>Windows 8.1</td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="see-also-24">See also</h3>

<ul>
<li><code><a href="ps_attribute_protection_level" title="#define PS_ATTRIBUTE_PROTECTION_LEVEL \&#10;    PsAttributeValue(PsAttributeProtectionLevel, FALSE, TRUE, TRUE)">PS_ATTRIBUTE_PROTECTION_LEVEL</a></code></li>
</ul>

<h2 id="tokenprivatenamespace-42">TokenPrivateNameSpace (42)</h2>

<p>This info class accesses the <code>TOKEN_PRIVATE_NAMESPACE</code> token flag.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>ULONG</code> or <code>BOOL</code></td>
  <td><code>ULONG</code> or <code>BOOL</code></td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
<tr>
  <td>Required privilege</td>
  <td>None</td>
  <td><code>SeTcbPrivilege</code></td>
</tr>
<tr>
  <td>Minimal version</td>
  <td>Windows 10 TH1 (1507)</td>
  <td>Windows 10 TH1 (1507)</td>
</tr>
</tbody>
</table>

<h2 id="tokensingletonattributes-43">TokenSingletonAttributes (43)</h2>

<p>Retrieves the list of singleton attributes associated with the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code><a href="token_security_attributes_information" title="typedef struct _TOKEN_SECURITY_ATTRIBUTES_INFORMATION&#10;{&#10;    USHORT Version;&#10;    USHORT Reserved;&#10;    ULONG AttributeCount;&#10;    union&#10;    {&#10;        PTOKEN_SECURITY_ATTRIBUTE_V1 pAttributeV1;&#10;    } Attribute;&#10;} TOKEN_SECURITY_ATTRIBUTES_INFORMATION, *PTOKEN_SECURITY_ATTRIBUTES_INFORMATION;">TOKEN_SECURITY_ATTRIBUTES_INFORMATION</a></code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Minimal version</td>
  <td>Windows 10 RS1 (1607)</td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h2 id="tokenbnoisolation-44">TokenBnoIsolation (44)</h2>

<p>Retrieves the Base Named Object Isolation rules for the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>TOKEN_BNO_ISOLATION_INFORMATION</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Minimal version</td>
  <td>Windows 10 RS2 (1703)</td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="see-also-25">See also</h3>

<ul>
<li><code><a href="proc_thread_attribute_bno_isolation" title="#define PROC_THREAD_ATTRIBUTE_BNO_ISOLATION \&#10;    ProcThreadAttributeValue(ProcThreadAttributeBnoIsolation, FALSE, TRUE, FALSE)">PROC_THREAD_ATTRIBUTE_BNO_ISOLATION</a></code></li>
</ul>

<h2 id="tokenchildprocessflags-45">TokenChildProcessFlags (45)</h2>

<p>Removes the child process creation restriction from the token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td>N/A</td>
  <td><code>ULONG</code> (<code>0</code>) or <code>BOOL</code> (<code>FALSE</code>)</td>
</tr>
<tr>
  <td>Required access</td>
  <td>N/A</td>
  <td><code>TOKEN_ADJUST_DEFAULT</code></td>
</tr>
<tr>
  <td>Minimal version</td>
  <td>N/A</td>
  <td>Windows 10 RS3 (1709)</td>
</tr>
<tr>
  <td>Required privilege</td>
  <td>N/A</td>
  <td><code>SeTcbPrivilege</code></td>
</tr>
</tbody>
</table>

<h3 id="remarks-14">Remarks</h3>

<p>To check the existing child process creation restrictions, query token flags and test them for <code>TOKEN_NO_CHILD_PROCESS</code>, <code>TOKEN_NO_CHILD_PROCESS_UNLESS_SECURE</code>, and <code>TOKEN_AUDIT_NO_CHILD_PROCESS</code>.</p>

<h2 id="see-also-26">See also</h2>

<ul>
<li><code><a href="ntqueryinformationprocess" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtQueryInformationProcess(&#10;    _In_ HANDLE ProcessHandle,&#10;    _In_ PROCESSINFOCLASS ProcessInformationClass,&#10;    _Out_writes_bytes_(ProcessInformationLength) PVOID ProcessInformation,&#10;    _In_ ULONG ProcessInformationLength,&#10;    _Out_opt_ PULONG ReturnLength&#10;    );">NtQueryInformationProcess</a></code> with <code><a href="processinfoclass" title="typedef enum _PROCESSINFOCLASS&#10;{&#10;    ProcessBasicInformation, // q: PROCESS_BASIC_INFORMATION, PROCESS_EXTENDED_BASIC_INFORMATION&#10;    ProcessQuotaLimits, // qs: QUOTA_LIMITS, QUOTA_LIMITS_EX&#10;    ProcessIoCounters, // q: IO_COUNTERS&#10;    ProcessVmCounters, // q: VM_COUNTERS, VM_COUNTERS_EX, VM_COUNTERS_EX2&#10;    ProcessTimes, // q: KERNEL_USER_TIMES&#10;    ProcessBasePriority, // s: KPRIORITY&#10;    ProcessRaisePriority, // s: ULONG&#10;    ProcessDebugPort, // q: HANDLE&#10;    ProcessExceptionPort, // s: PROCESS_EXCEPTION_PORT (requires SeTcbPrivilege)&#10;    ProcessAccessToken, // s: PROCESS_ACCESS_TOKEN&#10;    ProcessLdtInformation, // qs: PROCESS_LDT_INFORMATION // 10&#10;    ProcessLdtSize, // s: PROCESS_LDT_SIZE&#10;    ProcessDefaultHardErrorMode, // qs: ULONG&#10;    ProcessIoPortHandlers, // (kernel-mode only) // s: PROCESS_IO_PORT_HANDLER_INFORMATION&#10;    ProcessPooledUsageAndLimits, // q: POOLED_USAGE_AND_LIMITS&#10;    ProcessWorkingSetWatch, // q: PROCESS_WS_WATCH_INFORMATION[]; s: void&#10;    ProcessUserModeIOPL, // qs: ULONG (requires SeTcbPrivilege)&#10;    ProcessEnableAlignmentFaultFixup, // s: BOOLEAN&#10;...">PROCESSINFOCLASS</a></code> value of <code>ProcessChildProcessInformation</code> (73)</li>
<li><code><a href="ps_attribute_child_process_policy" title="#define PS_ATTRIBUTE_CHILD_PROCESS_POLICY \&#10;    PsAttributeValue(PsAttributeChildProcessPolicy, FALSE, TRUE, FALSE)">PS_ATTRIBUTE_CHILD_PROCESS_POLICY</a></code></li>
</ul>

<h2 id="tokenislessprivilegedappcontainer-46">TokenIsLessPrivilegedAppContainer (46)</h2>

<p>Determines if the token is a Less Privileged AppContainer (LPAC) token.</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>ULONG</code> or <code>BOOL</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Minimal version</td>
  <td>Windows 10 RS5 (1809)</td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="remarks-15">Remarks</h3>

<p>The LPAC flag replaces a regular AppContainer access check against <code>ALL APPLICATION PACKAGES</code> (<code>S-1-15-2-1</code>) with a check against <code>ALL RESTRICTED APPLICATION PACKAGES</code> (<code>S-1-15-2-2</code>).</p>

<p>Alternatively, you can query the <code>WIN://NOALLAPPPKG</code> attribute via the <code><a href="ntquerysecurityattributestoken" title="NTSYSCALLAPI&#10;NTSTATUS&#10;NTAPI&#10;NtQuerySecurityAttributesToken(&#10;    _In_ HANDLE TokenHandle,&#10;    _In_reads_opt_(NumberOfAttributes) PUNICODE_STRING Attributes,&#10;    _In_ ULONG NumberOfAttributes,&#10;    _Out_writes_bytes_(Length) PVOID Buffer, // PTOKEN_SECURITY_ATTRIBUTES_INFORMATION&#10;    _In_ ULONG Length,&#10;    _Out_ PULONG ReturnLength&#10;    );">NtQuerySecurityAttributesToken</a></code> function or the <code>TokenSecurityAttributes</code> info class and test for a non-zero value.</p>

<h3 id="see-also-27">See also</h3>

<ul>
<li><code><a href="ps_attribute_all_application_packages_policy" title="#define PS_ATTRIBUTE_ALL_APPLICATION_PACKAGES_POLICY \&#10;    PsAttributeValue(PsAttributeAllApplicationPackagesPolicy, FALSE, TRUE, FALSE)">PS_ATTRIBUTE_ALL_APPLICATION_PACKAGES_POLICY</a></code></li>
</ul>

<h2 id="tokenissandboxed-47">TokenIsSandboxed (47)</h2>

<p>Determines if the token is considered sandboxed (i.e., has integrity level below medium).</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>ULONG</code> or <code>BOOL</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Minimal version</td>
  <td>Windows 10 19H1 (1903)</td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="see-also-28">See also</h3>

<ul>
<li><code><a href="rtlchecksandboxedtoken" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlCheckSandboxedToken(&#10;    _In_opt_ HANDLE TokenHandle,&#10;    _Out_ PBOOLEAN IsSandboxed&#10;    );">RtlCheckSandboxedToken</a></code></li>
</ul>

<h2 id="tokenisappsilo-48">TokenIsAppSilo (48)</h2>

<p>Determines if the token has the AppSilo capability (<code>S-1-15-3-65536</code>).</p>

<table>
<thead>
<tr>
  <th></th>
  <th>Query</th>
  <th>Set</th>
</tr>
</thead>
<tbody>
<tr>
  <td>Type</td>
  <td><code>ULONG</code> or <code>BOOL</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Required access</td>
  <td><code>TOKEN_QUERY</code></td>
  <td>N/A</td>
</tr>
<tr>
  <td>Minimal version</td>
  <td>Windows 11 22H2</td>
  <td>N/A</td>
</tr>
</tbody>
</table>

<h3 id="remarks-16">Remarks</h3>

<p>This info class value was previously known as <code>TokenOriginatingProcessTrustLevel</code>.</p>

<h3 id="see-also-29">See also</h3>

<ul>
<li><code><a href="rtliscapabilitysid" title="NTSYSAPI&#10;BOOLEAN&#10;NTAPI&#10;RtlIsCapabilitySid(&#10;    _In_ PSID Sid&#10;    );">RtlIsCapabilitySid</a></code></li>
<li><code><a href="rtlderivecapabilitysidsfromname" title="NTSYSAPI&#10;NTSTATUS&#10;NTAPI&#10;RtlDeriveCapabilitySidsFromName(&#10;    _Inout_ PUNICODE_STRING UnicodeString,&#10;    _Out_ PSID CapabilityGroupSid,&#10;    _Out_ PSID CapabilitySid&#10;    );">RtlDeriveCapabilitySidsFromName</a></code></li>
</ul>
</div>
<div class="ntdoc-description-links">
<a target="_blank" href="https://github.com/m417z/ntdoc/blob/main/descriptions/token_information_class.md">Edit description on GitHub</a>
</div>

    <!-- For sticky footer: https://stackoverflow.com/a/34146411 -->
    <div class="spacer"></div>
    <footer>
        By <a href="https://m417z.com/" target="_blank" rel="noopener">m417z</a> &bull;
        content by <a href="https://github.com/diversenok" target="_blank" rel="noopener">diversenok</a> &bull;
        <a href="https://github.com/m417z/ntdoc" target="_blank" rel="noopener">GitHub repository</a> &bull;
        <dark-mode-toggle permanent></dark-mode-toggle>
    </footer>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YWF4NP61SX"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-YWF4NP61SX');
    </script>
    <script src="modules/jquery-3.7.0.min.js"></script>
    <script src="modules/q-1.5.1.js"></script>
    <script src="modules/virtual-select/virtual-select-jquery.min.js"></script>
    <script src="modules/popper-2.11.8.min.js"></script>
    <script src="modules/tippy-6.3.7.min.js"></script>
    <script src="modules/anchor-5.0.0.min.js"></script>
    <script type="module" src="modules/dark-mode-toggle-0.14.6.min.mjs"></script>
    <script src="ntdoc.js"></script>
</body>
</html>
